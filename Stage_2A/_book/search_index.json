[["sec-propMM.html", "Section 2 Moving average and filters 2.1 Gain and phase shift functions 2.2 Desirable properties of a moving average 2.3 Real-time estimation and asymmetric moving average", " Section 2 Moving average and filters Lots of papers describe the definition and the properties of moving average and linear filters (see for example Ladiray (2018)). In this section we summarize some of the main results. Let \\(p\\) et \\(f\\) two integers, a moving average \\(M_\\theta\\) or \\(M\\) is defined by a set of coefficients \\(\\theta=(\\theta_{-p},\\dots,\\theta_{f})&#39;\\) such as for all time series \\(X_t\\): \\[ M_\\theta(X_t)=\\sum_{k=-p}^{+f}\\theta_kX_{t+k} \\] \\(p+f+1\\) is called the moving average order. When \\(p=f\\) the moving average is said to be centered. If we also have \\(\\forall k:\\:\\theta_{-k} = \\theta_k\\), the moving average \\(M_\\theta\\) is said to be symmetric. In this case, the quantity \\(h=p=f\\) is called the bandwidth. 2.1 Gain and phase shift functions Let \\(X_t=\\e^{-i\\omega t}\\). The result of the moving average \\(M_\\theta\\) in \\(X_t\\) is: \\[ Y_t = M_{\\theta}X_t = \\sum_{k=-p}^{+f} \\theta_k \\e^{-i \\omega (t+k)} = \\left(\\sum_{k=-p}^{+f} \\theta_k \\e^{-i \\omega k}\\right)\\cdot X_t. \\] The function \\(\\Gamma_\\theta(\\omega)=\\sum_{k=-p}^{+f} \\theta_k e^{-i \\omega k}\\) is called the transfer function or frequency response function3. It can be rewritten as: \\[ \\Gamma_\\theta(\\omega) = G_\\theta(\\omega)\\e^{-i\\Phi_\\theta(\\omega)} \\] where \\(G_\\theta(\\omega)=\\lvert\\Gamma_\\theta(\\omega)\\rvert\\) is the gain or amplitude function and \\(\\Phi_\\theta(\\omega)\\) is the phase shift or time shift function4. For all symmetric moving average we have \\(\\Phi_\\theta(\\omega)\\equiv 0 \\pmod{\\pi}\\). To sum up, applying a moving average to a harmonic times series affects it in in two different ways: by multiplying it by an amplitude coefficient \\(G_{\\theta}\\left(\\omega\\right)\\); by “shifting” it in time by \\(\\Phi_\\theta(\\omega)/\\omega\\), which directly affects the detection of turning points5. Example: with \\(M_{\\theta_0}X_t=\\frac{1}{2}X_{t-1}+\\frac{1}{2}X_{t}\\) we have: \\[ \\Gamma_{\\theta_0}(\\omega)=\\frac{1}{2}+\\frac{1}{2}\\e^{-i\\omega} =\\lvert\\cos(\\omega/2)\\rvert\\e^{-i\\frac{\\omega}{2}} \\] The figure 2.1 illustrates the gain and the phase shift for \\(\\omega=\\pi/2\\) and \\(X_t=\\sin(\\omega t)\\). Figure 2.1: Smoothing of the time series \\(X_t=\\sin(\\omega t)\\) by the moving average \\(M_{\\theta_0}X_t=\\frac{1}{2}X_{t-1}+\\frac{1}{2}X_{t}\\) for \\(\\omega=\\pi/2\\). 2.2 Desirable properties of a moving average The moving average are often constructed under some specific constraints. In the report we will focus on two constraints: the preservation of certain kind of trends; the variance reduction. 2.2.1 Trend preservation It is often desirable for a moving average to conserve certain kind of trends. A moving average \\(M_\\theta\\) conserve a function of the time \\(f(t)\\) if \\(\\forall t:\\:M_\\theta f(t)=f(t)\\). We have the following properties for the moving average \\(M_\\theta\\): To conserve a constant series \\(X_t=a\\) we need \\[ \\forall t:M_\\theta(X_t)=\\sum_{k=-p}^{+f}\\theta_kX_{t+k}=\\sum_{k=-p}^{+f}\\theta_ka=a\\sum_{k=-p}^{+f}\\theta_k=a \\] the sum of the coefficients of the moving average \\(\\sum_{k=-p}^{+f}\\theta_k\\) must then be equal to \\(1\\). To conserve a linear trend \\(X_t=at+b\\) we need: \\[ \\forall t:\\:M_\\theta(X_t)=\\sum_{k=-p}^{+f}\\theta_kX_{t+k}=\\sum_{k=-p}^{+f}\\theta_k[a(t+k)+b]=at\\sum_{k=-p}^{+f}k\\theta_k+b\\sum_{k=-p}^{+f}\\theta_k=at+b \\] which is equivalent to: \\[ \\sum_{k=-p}^{+f}\\theta_k=1 \\quad\\text{and}\\quad \\sum_{k=-p}^{+f}k\\theta_k=0 \\] In general, it can be shown that \\(M_\\theta\\) conserves a polynomial of degree \\(d\\) if and only if: \\[ \\sum_{k=-p}^{+f}\\theta_k=1 \\text{ and } \\forall j \\in \\left\\llbracket 1,d\\right\\rrbracket:\\: \\sum_{k=-p}^{+f}k^j\\theta_k=0 \\] If \\(M_\\theta\\) is symmetric (\\(p=f\\) and \\(\\theta_{-k} = \\theta_k\\)) and conserves polynomial of degree \\(2d\\) then it also conserves polynomial of degree \\(2d+1\\). 2.2.2 Variance reduction All time series are affected by noise that can blur the signal extraction. Hence, we seek to reduce the variance of the noise. The sum of the squares of the coefficients \\(\\sum_{k=-p}^{+f}\\theta_k^2\\) is the variance reduction ratio. Indeed, let \\(\\{\\varepsilon_t\\}\\) a sequence of independent random variables with \\(\\E{\\varepsilon_t}=0\\), \\(\\V{\\varepsilon_t}=\\sigma^2\\). \\[ \\V{M_\\theta\\varepsilon_t}=\\V{\\sum_{k=-p}^{+f} \\theta_k \\varepsilon_{t+k}} = \\sum_{k=-p}^{+f} \\theta_k^2 \\V{\\varepsilon_{t+k}}= \\sigma^2\\sum_{k=-p}^{+f} \\theta_k^2 \\] 2.3 Real-time estimation and asymmetric moving average For symmetric filters, the phase shift function is equal to zero (modulo \\(\\pi\\)). Therefore, there is no delay in any frequency: that’s why they are preferred to the asymmetric ones. However, they cannot be used in the beginning and in the end of the time series because no past/future value can be used. Thus, for real-time estimation, it is needed to build asymmetric moving average that approximate the symmetric moving average. The approximation is summarized by quality indicators. In this paper we focus on the ones defined by Grun-Rehomme, Guggemos, and Ladiray (2018) and Wildi and McElroy (2019) to build the asymmetric filters. Grun-Rehomme, Guggemos, and Ladiray (2018) propose a general approach to derive linear filters, based on an optimization problem of three criteria: Fidelity (\\(F_g\\), noise reduction), Smoothness (\\(S_g\\)) and Timeliness (\\(T_g\\), phase shift between input and ouput signals). See section 4 for more details. Wildi and McElroy (2019) propose an approach based on the decomposition of the mean squared error between the symmetric and the asymmetric filter in four quantities: Accuracy (\\(A_w\\)), Timeliness (\\(T_w\\)), Smoothness (\\(S_w\\)) and Residual (\\(R_w\\)). See section 5 for more details. All the indicators are summarized in table ??. References "]]
